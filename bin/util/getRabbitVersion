#!/bin/bash

## get and unpack version of RabbitMQ:

echo "Get and unpack rabbit generic unix version '$1'"

[ "$1" == "" ] && echo "Must supply a version number" && exit 1

rmq_version=$1

echo "Fetching rabbitmq-generic-unix version ${rmq_version} from www.rabbitmq.com ..."
sudo curl http://www.rabbitmq.com/releases/rabbitmq-server/v${rmq_version}/rabbitmq-server-generic-unix-${rmq_version}.tar.gz -O || (echo "fetch failed"; exit 1)

echo ""
echo "Unpacking tar file rabbitmq-server-generic-unix-${rmq_version}.tar.gz into /opt/vmware/ ..."
sudo tar -C /opt/vmware -xf rabbitmq-server-generic-unix-${rmq_version}.tar.gz || (echo "tar -xf failed"; exit 1)

echo ""
echo "Removing tar file ..."
sudo rm rabbitmq-server-generic-unix-${rmq_version}.tar.gz || (echo "tar file not removed"; exit 1)
