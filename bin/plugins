#!/bin/bash

# Uses $1 and sets local RJMS_* vars:
source bin/set-vars

echo "Plugins for RabbitMQ server (version ${RMQ_VERSION}) in Integration Tests"
echo "rabbitmq-plugins $2 $3 $4 $5"

if [[ ! -d "${RJMS_RABBITMQ_BASE}" ]] ; then
  echo "Could not find a directory called '${RJMS_RABBITMQ_BASE}'"
  exit 1
fi

(sudo ${RJMS_RABBITMQ_BASE}/sbin/rabbitmq-plugins -n ${RJMS_RABBITMQ_NODENAME} $2 $3 $4 $5 \
    && echo '-------------------' && echo 'plugged-in') \
 || (echo '------------------' && echo 'rabbitmq-plugins failed')
